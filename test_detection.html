<!DOCTYPE html>
<html>
<head>
    <title>Teste de Detec√ß√£o RedeX</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Teste de Detec√ß√£o de Layout RedeX</h1>
    
    <input type="file" id="fileInput" accept=".xlsx,.xls" onchange="testDetection(event)">
    
    <div id="results"></div>
    
    <script>
        function testDetection(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = e.target.result;
                const workbook = XLSX.read(data, { type: 'binary' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                console.log('=== AN√ÅLISE COMPLETA DA PLANILHA ===');
                
                // Primeira linha
                const columns1 = [];
                for (const key in worksheet) {
                    if (/^[A-Z]1$/.test(key) && worksheet[key].v) {
                        columns1.push(worksheet[key].v);
                    }
                }
                console.log('Linha 1:', columns1);
                
                // Buscar cabe√ßalho RedeX nas linhas 50-60
                for (let row = 50; row <= 60; row++) {
                    const rowCells = [];
                    for (const key in worksheet) {
                        if (new RegExp(`^[A-Z]${row}$`).test(key) && worksheet[key].v) {
                            rowCells.push(worksheet[key].v);
                        }
                    }
                    
                    if (rowCells.length > 0) {
                        console.log(`Linha ${row}:`, rowCells);
                        
                        // Verificar se √© o cabe√ßalho RedeX
                        if (rowCells.includes('Loja') && rowCells.includes('GTIN/PLU Unit√°rio')) {
                            console.log(`üéØ CABE√áALHO REDEX ENCONTRADO na linha ${row}!`);
                            document.getElementById('results').innerHTML = `
                                <h2>‚úÖ Cabe√ßalho RedeX Detectado na Linha ${row}</h2>
                                <ul>${rowCells.map(col => `<li>${col}</li>`).join('')}</ul>
                            `;
                            return;
                        }
                    }
                }
                
                document.getElementById('results').innerHTML = '<h2>‚ùå Cabe√ßalho RedeX n√£o encontrado</h2>';
            };
            
            reader.readAsBinaryString(file);
        }
    </script>
</body>
</html>